<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at May 6, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Brett Porter" />
    <meta name="Date-Revision-yyyymmdd" content="20130506" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Redback Spring Registry Component - Plexus Registry Component</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarEnabled">
          
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">ASF <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="http://www.apache.org/foundation/how-it-works.html"  title="How Apache Works">How Apache Works</a>
</li>
                  
                      <li>      <a href="http://www.apache.org/foundation/"  title="Foundation">Foundation</a>
</li>
                  
                      <li>      <a href="http://www.apache.org/foundation/sponsorship.html"  title="Sponsoring Apache">Sponsoring Apache</a>
</li>
                  
                      <li>      <a href="http://www.apache.org/foundation/thanks.html"  title="Thanks">Thanks</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="index.html"  title="About">About</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="modules.html"  title="Project Modules">Project Modules</a>
</li>
                                  <li>      <a href="dependency-info.html"  title="Dependency Information">Dependency Information</a>
</li>
                                  <li>      <a href="dependency-management.html"  title="Dependency Management">Dependency Management</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="integration.html"  title="Continuous Integration">Continuous Integration</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="dependency-convergence.html"  title="Dependency Convergence">Dependency Convergence</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="plugin-management.html"  title="Plugin Management">Plugin Management</a>
</li>
                                  <li>      <a href="distribution-management.html"  title="Distribution Management">Distribution Management</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                                  <li>      <a href="mail-lists.html"  title="Mailing Lists">Mailing Lists</a>
</li>
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
                      <form id="search-form" action="http://www.google.com/search" method="get"  class="navbar-search pull-right" >
    
  <input value="http://archiva.apache.org/redback/components" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
                                                    
        
        
        <ul class="nav pull-right"><li>
    
    <a href="https://twitter.com/archiva" class="twitter-follow-button" data-show-count="false" data-align="right" data-size="large" data-show-screen-name="true" data-lang="en">Follow archiva</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        </li></ul>
                
                               <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
                      <li>      <a href="../../.."  title="Archiva">Archiva</a>
</li>
                  </ul>
              </li>
            </ul>
          
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../../../index.html" id="bannerLeft">
                                                                                                <img src="../../../images/archiva.png"  alt="Apache Archiva"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://www.apache.org/" id="bannerRight">
                                                                                        <img src="http://www.apache.org/images/asf_logo_wide.png"  alt="Apache Software Foundation"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2013-05-06</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 2.1</li>
                          <li class="divider">|</li>             <li class="">
                    <a href="http://www.apache.org/" class="externalLink" title="Apache">
        Apache</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../../../../../../../../../file:/Users/olamy/redback-components-site-deploy/redback-components/" title="Apache Archiva Redback Components">
        Apache Archiva Redback Components</a>
        </li>
      <li class="divider ">/</li>
                <li class="">
                    <a href="./" title="Redback Spring Registry Component">
        Redback Spring Registry Component</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Plexus Registry Component</li>
                
                
                    
      
                            </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            <!-- Licensed to the Apache Software Foundation (ASF) under one --><!-- or more contributor license agreements.  See the NOTICE file --><!-- distributed with this work for additional information --><!-- regarding copyright ownership.  The ASF licenses this file --><!-- to you under the Apache License, Version 2.0 (the --><!-- "License"); you may not use this file except in compliance --><!-- with the License.  You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, --><!-- software distributed under the License is distributed on an --><!-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY --><!-- KIND, either express or implied.  See the License for the --><!-- specific language governing permissions and limitations --><!-- under the License. --><!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/guides/mini/guide-apt-format.html --><div class="section"><h2>Plexus Registry<a name="Plexus_Registry"></a></h2><p>The Plexus registry is a single source of external configuration for Plexus components and applications. It can be used by components to source configuration, knowing that it can be used from within applications without the information being hard coded into the component.</p><p>To facilitate a variety of providers, <a class="externalLink" href="http://jakarta.apache.org/commons/configuration/"> Commons Configuration</a> is used to implement the backing storage.</p><p>This relies on a pull-based (or lookup) mechanism - the applications request specific pieces of configuration at the time they need them, and it is retrieved from the registry.</p><p>The registry is configurable so that configuration can be placed in any location desired, and is shared container wide. A registry using the same file as other running VMs should operate correctly.</p><p><i>Note:</i> Inside the application server, this means that the scope is application wide as each application has it's own container. It may be feasible to provide a single registry for the whole server, but this has not yet been tested. This would only be necessary if the server was to dictate configuration locations that the registry was not already configured to use. Of course, such additional locations could be added to the application registry instances programmatically as well.</p><div class="section"><h3>Example Configuration<a name="Example_Configuration"></a></h3><div><pre>&lt;component&gt;
  &lt;role&gt;org.codehaus.redback.components.registry.Registry&lt;/role&gt;
  &lt;implementation&gt;org.codehaus.plexus.registry.CommonsConfigurationRegistry&lt;/implementation&gt;
  &lt;role-hint&gt;commons-configuration&lt;/role-hint&gt;
  &lt;configuration&gt;
    &lt;properties&gt;
      &lt;system/&gt;
      &lt;jndi prefix=&quot;java:comp/env&quot; config-optional=&quot;true&quot;/&gt;
      &lt;xml fileName=&quot;${user.home}/.m2/archiva.xml&quot; config-optional=&quot;true&quot; config-name=&quot;org.apache.maven.archiva&quot;
           config-at=&quot;org.apache.maven.archiva&quot; config-forceCreate=&quot;true&quot;/&gt;
      &lt;properties fileName=&quot;${user.home}/.m2/security.properties&quot; config-optional=&quot;true&quot;
                  config-at=&quot;org.codehaus.plexus.security&quot;/&gt;
    &lt;/properties&gt;
  &lt;/configuration&gt;
&lt;/component&gt;</pre></div><p>The configuration inside the outer <tt>&lt;properties&gt;</tt> element is equivalent to the <a class="externalLink" href="http://jakarta.apache.org/commons/configuration/howto_configurationbuilder.html#Using_DefaultConfigurationBuilder"> builder syntax</a> for Commons Configuration. This maps to similar concepts in the registry.</p><p>In this example, the precedence is to first look in the system properties, then JNDI, then the given XML file, and finally the given properties file.</p><p>Registries can have 'sections', which are declared as partitioned areas of the registry. This is done using the <tt>config-name</tt> attribute in Commons Configuration. While the sections behave normally as a part of the global registry, they can easily be retrieved independently. This is particularly useful for write-back operations so the file the section is stored in can be saved when the registry is modified.</p><p>Each configuration source can be configured with a given mount-point in the registry using the <tt>config-at</tt> attribute. This will cause all of the properties to be stored with the given prefix.</p></div><div class="section"><h3>Using the Registry <a name="Using_the_Registry"></a></h3><p>The registry can be used as a simple directory, for example:</p><div><pre>int value = registry.getInt( &quot;test.property&quot; );
String text = registry.getString( &quot;text.data&quot; );
boolean enabled = registry.getBoolean( &quot;system.enabled&quot;, true );</pre></div><p>The first parameter is always a key. The registry is hierachical, so in the key, a <tt>.</tt> (period) represents a nested configuration, and can be traversed to any level.</p><p>The second parameter specifies a default value. If it is not given, then <tt>null</tt> is returned for strings if the key is not found in the registry, and an exception is thrown for integers and booleans under the same circumstances.</p><div class="section"><h4>Subsets and Sections<a name="Subsets_and_Sections"></a></h4><p>There are two ways to work with a portion of the registry at a time: subsets and sections.</p><p>Sections were encountered earlier - and while they return a subset it may span a number of different base prefixes, depending on whether <tt>config-at</tt> was specified on the section or not. Even so, if it is a subset of the hierachy, some elements of the hierachy at the same level might not be returned because they come from a different section.</p><p>On the other hand, subsets are reductions of the registry to keys descending from a given prefix.</p><p>Once a subset (or section) is obtained, it behaves the same as the registry as a whole, however it will have fewer values, and looking up values will not have the prefix as a part of the key.</p><p>For example:</p><div><pre>String value = registry.getString( &quot;org.codehaus.plexus.registry.value&quot; );
Registry subset = registry.getSubset( &quot;org.codehaus.plexus.registry&quot; );
value = subset.getString( &quot;value&quot; ); // this will equal the earlier value retrieved</pre></div></div><div class="section"><h4>Lists and Maps<a name="Lists_and_Maps"></a></h4><p>It is also possible to retrieve subsets of the registry as collections.</p><ul><li><tt>getProperties(key)</tt>: Maps and properties are straightforward - the subset is converted into key/value pairs and returned as a map.</li><li><tt>getSubsetList(key)</tt>: For lists of complex types that will still contain more than one key/value pair, this method can be used to retrieve them as a list of subset registries.</li><li><tt>getList(key)</tt>: For lists of simple types, this method can be used to get a list of value objects.</li></ul></div><div class="section"><h4>Using Models<a name="Using_Models"></a></h4><p>To simplify the translation of configuration into reusable beans and to produce a self-documenting system, Modello can be used to generate registry I/O classes. The appropriate goals in the plugin are <tt>registry-reader</tt> and <tt>registry-writer</tt>.</p></div><div class="section"><h4>Saving Changes<a name="Saving_Changes"></a></h4><p>Saving changes to a registry is quite simple:</p><div><pre>registry.save();</pre></div><p>Note that the registry must be a file-based section (saving the entire registry will not succeed). It will be saved to the same location that it was loaded from.</p></div><div class="section"><h4>Adding Change Listeners<a name="Adding_Change_Listeners"></a></h4><!-- TODO --></div></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
              <div class="row span12">Copyright &copy;                    2006-2013
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All Rights Reserved.      
                    
      </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/8659/widgets/project_basic_stats.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>